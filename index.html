<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³¢å¦®é¼ å†’é™©:æ¢§æ¡æ—çš„å’³å—½</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .sensor-ball {
            width: 30px;
            height: 30px;
            background: #ff4444;
            border-radius: 50%;
            display: inline-block;
            margin: 0 10px;
            animation: pulse 1.5s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.8);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }

        .title {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
        }

        .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .game-content {
            padding: 40px;
        }

        .story-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 25px;
            margin-bottom: 30px;
            border-radius: 8px;
            line-height: 1.8;
            font-size: 16px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 20px;
            background: #f0f4ff;
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-btn {
            background: white;
            border: 2px solid #667eea;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 16px;
            color: #333;
        }

        .choice-btn:hover {
            background: #667eea;
            color: white;
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .choice-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }

        .choice-btn:hover .choice-number {
            background: white;
            color: #667eea;
        }

        .quiz-container {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .quiz-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .quiz-question {
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .result {
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 18px;
        }

        .result.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }

        .result.failure {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .ending {
            text-align: center;
            padding: 30px;
        }

        .title-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.5);
        }

        .restart-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .restart-btn:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        .sound-effect {
            font-style: italic;
            color: #667eea;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <div class="sensor-ball"></div>
            <h1 class="title">æ³¢å¦®é¼ çš„é¥æ„Ÿå†’é™©</h1>
            <p class="subtitle">ç¬¬ä¸€ç« :æ¢§æ¡æ—çš„å’³å—½</p>
        </div>

        <div class="game-content">
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-label">å½“å‰ç« èŠ‚</div>
                    <div class="stat-value" id="round">1/7</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">çŸ¥è¯†åˆ†æ•°</div>
                    <div class="stat-value" id="score">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">å†³ç­–ç±»å‹</div>
                    <div class="stat-value" id="decisionType">å‡è¡¡</div>
                </div>
            </div>

            <div class="story-box" id="story"></div>
            <div id="quiz-area"></div>
            <div class="choices" id="choices"></div>
        </div>
    </div>

    <script>
        const gameState = {
            round: 1,
            score: 0,
            cautiousCount: 0,
            boldCount: 0,
            knowledgeCorrect: 0,
            playerChoices: []
        };

        const story = {
            1: {
                text: `åˆåçš„é˜³å…‰æ´’åœ¨æ ¡å›­é‡Œ,ä½ æŠ±ç€ä¸€æ‘<é¥æ„ŸåŸç†>è¯¾æœ¬ç»è¿‡æ¢§æ¡æ—ã€‚çªç„¶â€”â€”<span class="sound-effect">"å˜€å˜€!å˜€å˜€!"</span> ä½ å¤´é¡¶çš„å¤šè°±æ®µä¼ æ„Ÿçƒå¼€å§‹æ€¥ä¿ƒé—ªçƒ,çº¢å…‰åƒå¿ƒè·³ä¸€æ ·è·³åŠ¨ç€ã€‚\n\nä½ åœä¸‹è„šæ­¥,æœ¬èƒ½åœ°ä¸¾èµ·å³æ‰‹è°ƒæ•´æ„Ÿåº”å™¨ã€‚æ•°æ®æµåœ¨è§†é‡ä¸­å±•å¼€:è¿™ç‰‡æ¢§æ¡æ—çš„æ¤è¢«æŒ‡æ•°å¼‚å¸¸åä½,å¶ç»¿ç´ åå°„ç‡ä¸‹é™äº†23%ã€‚\n\n"å’³å’³â€¦â€¦"ä¸€é˜µå¾®å¼±çš„å£°éŸ³ä¼ æ¥,ä»¿ä½›æ ‘å¶åœ¨ä½å£°å‘»åŸã€‚ä½ æŠ¬å¤´æœ›å»,åŸæœ¬éƒéƒè‘±è‘±çš„æ ‘å† ,å¦‚ä»Šæœ‰äº›å¶ç‰‡æ³›é»„,è¾¹ç¼˜å·æ›²ã€‚\n\nä½œä¸ºä¸€åé¥æ„Ÿç ”ç©¶ç”Ÿ,ä½ çŸ¥é“è¿™ä¸æ˜¯æ™®é€šçš„å­£èŠ‚æ€§å˜åŒ–ã€‚æ¢§æ¡æ—åœ¨å‘ä½ æ±‚æ•‘!`,
                choices: [
                    { text: "ç«‹å³ç”¨ä¾¿æºå¼å…‰è°±ä»ªç°åœºé‡‡é›†æ•°æ®", type: "bold" },
                    { text: "å…ˆå›å®éªŒå®¤è°ƒå–å†å²å«æ˜Ÿå½±åƒå¯¹æ¯”åˆ†æ", type: "cautious" },
                    { text: "æ‰¾å›­æ—ç®¡ç†å‘˜äº†è§£è¿‘æœŸæƒ…å†µ", type: "balanced" }
                ]
            },
            2: {
                text: (choice) => {
                    if (choice === 0) return `ä½ ä»èƒŒåŒ…é‡Œæå‡ºä¾¿æºå¼å…‰è°±ä»ª,è¹²åœ¨ä¸€æ£µç—…æ€çš„æ¢§æ¡æ ‘å‰ã€‚<span class="sound-effect">"å—¡å—¡â€¦â€¦"</span>ä»ªå™¨å¼€å§‹å·¥ä½œ,çº¢å¤–ã€å¯è§å…‰ã€è¿‘çº¢å¤–æ³¢æ®µçš„åå°„ç‡æ›²çº¿åœ¨å±å¹•ä¸Šè·³åŠ¨ã€‚\n\nä½ çš„é¢†å¸¦å› ä¸ºè¹²å§¿æœ‰ç‚¹æ­ªäº†,ä½†ä½ é¡¾ä¸ä¸Šæ•´ç†ã€‚å¤´é¡¶çš„ä¼ æ„Ÿçƒéšç€æ•°æ®æµå…¥é—ªçƒå¾—æ›´å¿«ã€‚\n\nçªç„¶,ä½ æ³¨æ„åˆ°äº†å¼‚å¸¸:"çº¢è¾¹ä½ç½®æ˜æ˜¾è“ç§»!è¿™æ˜¯æ¤ç‰©å—åˆ°èƒè¿«çš„å…¸å‹ç‰¹å¾â€¦â€¦"ä½ çš±èµ·çœ‰å¤´,å°å£°å˜€å’•ç€ã€‚`;
                    if (choice === 1) return `ä½ å¿«æ­¥è·‘å›å®éªŒå®¤,åŒæ‰‹åœ¨é”®ç›˜ä¸Šé£èˆã€‚<span class="sound-effect">"å“’å“’å“’â€¦â€¦"</span>è°ƒå‡ºäº†è¿‡å»ä¸‰ä¸ªæœˆçš„Sentinel-2å«æ˜Ÿå½±åƒã€‚\n\nå±å¹•ä¸Š,NDVIæ—¶é—´åºåˆ—å›¾å‘ˆç°å‡ºä»¤äººæ‹…å¿§çš„ä¸‹é™è¶‹åŠ¿ã€‚ä½ è°ƒæ•´äº†ä¸€ä¸‹æ­ªæ‰çš„é¢†å¸¦,å¤´é¡¶çš„ä¼ æ„Ÿçƒæ˜ ç…§åœ¨æ˜¾ç¤ºå™¨ä¸Š,æŠ•ä¸‹çº¢è‰²çš„å…‰æ–‘ã€‚\n\n"ä»8æœˆå¼€å§‹å°±æœ‰å¼‚å¸¸â€¦â€¦è¿™ä¸æ˜¯çªå‘äº‹ä»¶,æ˜¯æŒç»­æ€§çš„ç¯å¢ƒå‹åŠ›!"ä½ æ¨äº†æ¨é¼»æ¢ä¸Šå¹¶ä¸å­˜åœ¨çš„çœ¼é•œâ€”â€”è¿™æ˜¯ä½ ç´§å¼ æ—¶çš„å°åŠ¨ä½œã€‚`;
                    return `ä½ æ‰¾åˆ°äº†å›­æ—éƒ¨çš„å¼ å¸ˆå‚…,ä¸€ä½åœ¨å­¦æ ¡å·¥ä½œäº†äºŒåå¹´çš„è€å‘˜å·¥ã€‚ä»–æ­£åœ¨ç»™èŠ±å›æµ‡æ°´ã€‚\n\n"å¼ å¸ˆå‚…,æ¢§æ¡æ—æœ€è¿‘æ˜¯ä¸æ˜¯æœ‰ä»€ä¹ˆé—®é¢˜?"\n\nå¼ å¸ˆå‚…æ”¾ä¸‹æ°´ç®¡,å¹äº†å£æ°”:"å°æ³¢å¦®å•Š,ä½ ä¹Ÿçœ‹å‡ºæ¥äº†?è¿™ä¸ªæœˆæ ‘å¶ä¸€ç›´ä¸å¯¹åŠ²,æˆ‘ä¹Ÿè¯´ä¸ä¸Šæ¥å“ªé‡Œæ€ªã€‚ä¸è¿‡â€¦â€¦"ä»–æŒ‡äº†æŒ‡ä¸è¿œå¤„æ­£åœ¨æ–½å·¥çš„æ–°æ•™å­¦æ¥¼,"é‚£è¾¹å·¥åœ°æœ€è¿‘åœ¨æ‰“æ¡©,éœ‡åŠ¨æŒºå¤§çš„ã€‚"`;
                }
            },
            3: {
                quiz: true,
                quizData: {
                    question: "ä½ éœ€è¦åˆ¤æ–­æ¤è¢«å¥åº·çŠ¶å†µã€‚åœ¨å¤šå…‰è°±é¥æ„Ÿä¸­,å“ªä¸ªæ¤è¢«æŒ‡æ•°æœ€é€‚åˆç›‘æµ‹æ¤è¢«ç”Ÿé•¿çŠ¶æ€å’Œå¶ç»¿ç´ å«é‡?",
                    options: [
                        "NDVI (å½’ä¸€åŒ–æ¤è¢«æŒ‡æ•°)",
                        "NDWI (å½’ä¸€åŒ–æ°´ä½“æŒ‡æ•°)", 
                        "NDBI (å½’ä¸€åŒ–å»ºç­‘æŒ‡æ•°)",
                        "BSI (è£¸åœŸæŒ‡æ•°)"
                    ],
                    correct: 0,
                    explanation: "NDVIåˆ©ç”¨è¿‘çº¢å¤–å’Œçº¢å…‰æ³¢æ®µçš„åå°„ç‡å·®å¼‚,èƒ½æœ‰æ•ˆåæ˜ æ¤è¢«çš„ç”Ÿé•¿çŠ¶å†µå’Œå¶ç»¿ç´ å«é‡ã€‚å¥åº·æ¤è¢«åœ¨è¿‘çº¢å¤–æ³¢æ®µåå°„ç‡é«˜ã€çº¢å…‰æ³¢æ®µåå°„ç‡ä½,NDVIå€¼æ¥è¿‘1;è€Œå—æŸæ¤è¢«NDVIå€¼ä¼šæ˜æ˜¾é™ä½ã€‚"
                },
                text: `ä½ å†³å®šè¿›è¡Œç³»ç»Ÿæ€§çš„é¥æ„Ÿåˆ†æã€‚æ‰“å¼€ç¬”è®°æœ¬ç”µè„‘,å¼€å§‹å¤„ç†å¤šå…‰è°±æ•°æ®ã€‚å¤´é¡¶çš„ä¼ æ„Ÿçƒ<span class="sound-effect">"å˜€å˜€"</span>ä¸¤å£°,ä¼¼ä¹åœ¨å‚¬ä¿ƒä½ ã€‚\n\nä½†åœ¨è®¡ç®—æ¤è¢«æŒ‡æ•°ä¹‹å‰,ä½ éœ€è¦é€‰æ‹©æ­£ç¡®çš„æŒ‡æ ‡â€¦â€¦`
            },
            4: {
                text: (quizResult) => {
                    if (quizResult) {
                        return `<span class="sound-effect">"å®!"</span> ä½ çš„ä¼ æ„Ÿçƒå‘å‡ºäº†æ„‰æ‚¦çš„ç»¿å…‰â€”â€”ç­”å¯¹äº†!\n\nä½ è¿…é€Ÿè®¡ç®—äº†æ•´ç‰‡æ—åŒºçš„NDVIå€¼ã€‚ç»“æœæ˜¾ç¤º:å¥åº·åŒºåŸŸNDVIåœ¨0.7-0.8ä¹‹é—´,è€Œé è¿‘æ–°æ•™å­¦æ¥¼æ–½å·¥åŒºåŸŸçš„æ ‘æœ¨NDVIå·²ç»è·Œè‡³0.4-0.5ã€‚\n\n"æœç„¶æœ‰é—®é¢˜!"ä½ å…´å¥‹åœ°ç«™èµ·æ¥,å·®ç‚¹æ‰“ç¿»æ¡Œä¸Šçš„å’–å•¡ã€‚é€šè¿‡çƒ­çº¢å¤–æ³¢æ®µåˆ†æ,ä½ è¿˜å‘ç°å¼‚å¸¸åŒºåŸŸçš„åœ°è¡¨æ¸©åº¦æ¯”æ­£å¸¸åŒºåŸŸé«˜å‡º2-3â„ƒã€‚\n\nç°åœ¨æœ‰ä¸‰æ¡çº¿ç´¢:\n1. æ–½å·¥åŒºåŸŸé™„è¿‘çš„æ¤è¢«å—æŸæœ€ä¸¥é‡\n2. åœ°è¡¨æ¸©åº¦å¼‚å¸¸å‡é«˜\n3. é—®é¢˜ä»ä¸¤ä¸ªæœˆå‰å°±å¼€å§‹äº†`;
                    } else {
                        return `ä½ çš„ä¼ æ„Ÿçƒ<span class="sound-effect">"å˜€å˜€å˜€"</span>è¿ç»­ä¸‰å£°â€”â€”é€‰é”™äº†!å®ƒç”¨å¿«é€Ÿé—ªçƒæé†’ä½ é‡æ–°æ€è€ƒã€‚\n\nè™½ç„¶èµ°äº†ç‚¹å¼¯è·¯,ä½†ä½ æœ€ç»ˆè¿˜æ˜¯ç”¨NDVIè¿›è¡Œäº†åˆ†æã€‚æ•°æ®æ˜¾ç¤º:å¥åº·åŒºåŸŸNDVIåœ¨0.7-0.8,è€Œæ–½å·¥åŒºé™„è¿‘è·Œè‡³0.4-0.5ã€‚\n\n"çœ‹æ¥æˆ‘è¿˜æ˜¯å¤ªç´§å¼ äº†â€¦â€¦"ä½ å°å£°å˜€å’•ç€,æ•´ç†äº†ä¸€ä¸‹é¢†å¸¦ã€‚ä¸è¿‡å¥½åœ¨æ•°æ®ä¸ä¼šéª—äºº,å¼‚å¸¸åŒºåŸŸå·²ç»é”å®šäº†ã€‚`;
                    }
                },
                choices: [
                    { text: "å»æ–½å·¥ç°åœºå®åœ°å‹˜å¯Ÿ,å¯»æ‰¾ç›´æ¥è¯æ®", type: "bold" },
                    { text: "ç”¨æ— äººæœºæ­è½½å¤šå…‰è°±ç›¸æœºåšç²¾ç»†åŒ–æ‰«æ", type: "cautious" },
                    { text: "å…ˆå»ºç«‹æ•°å€¼æ¨¡å‹æ¨¡æ‹Ÿå¯èƒ½çš„å½±å“å› ç´ ", type: "balanced" }
                ]
            },
            5: {
                text: (choice) => {
                    if (choice === 0) return `ä½ æˆ´ä¸Šå®‰å…¨å¸½,èµ°è¿›äº†æ–½å·¥åŒºåŸŸã€‚å·¥äººä»¬æ­£åœ¨æ“ä½œå¤§å‹æ‰“æ¡©æœº,<span class="sound-effect">"è½°éš†è½°éš†"</span>çš„å£°éŸ³éœ‡å¾—ä½ çš„ä¼ æ„Ÿçƒéƒ½è·Ÿç€é¢¤åŠ¨ã€‚\n\nä½ è¹²ä¸‹èº«,ç”¨æ‰‹è§¦æ‘¸åœ°é¢â€”â€”æ˜æ˜¾æ„Ÿè§‰åˆ°éœ‡åŠ¨ã€‚æ›´é‡è¦çš„æ˜¯,ä½ åœ¨æ–½å·¥åŒºè¾¹ç¼˜å‘ç°äº†ä¸€ä¸ªç»†èŠ‚:å‡ æ ¹ç²—å¤§çš„æ¢§æ¡æ ‘æ ¹éƒ¨æš´éœ²åœ¨å¤–,è¡¨é¢æœ‰æ˜æ˜¾çš„æœºæ¢°æŸä¼¤ç—•è¿¹!\n\n"éœ‡åŠ¨å‹å®äº†åœŸå£¤,æ ¹ç³»å—æŸæ— æ³•æ­£å¸¸å‘¼å¸å’Œå¸æ°´â€¦â€¦"ä½ æç„¶å¤§æ‚Ÿã€‚`;
                    if (choice === 1) return `ç¬¬äºŒå¤©æ¸…æ™¨,ä½ æ“æ§ç€å®éªŒå®¤çš„å¤šå…‰è°±æ— äººæœºèµ·é£ã€‚<span class="sound-effect">"å—¡å—¡å—¡â€”â€”"</span>å®ƒåœ¨æ¢§æ¡æ—ä¸Šæ–¹30ç±³å¤„ç›˜æ—‹,æ¯ç§’ä¼ å›é«˜åˆ†è¾¨ç‡çš„å¤šæ³¢æ®µå½±åƒã€‚\n\nä½ çš„ä¼ æ„Ÿçƒå…´å¥‹åœ°é—ªçƒç€,ä¼¼ä¹åœ¨å’Œæ— äººæœºçš„ä¼ æ„Ÿå™¨å…±é¸£ã€‚å±å¹•ä¸Š,å‡å½©è‰²åˆæˆå½±åƒæ¸…æ™°æ˜¾ç¤º:å—æŸåŒºåŸŸå‘ˆç°å‡ºæ˜æ˜¾çš„è¤çº¢è‰²,å¹¶ä¸”æŸä¼¤ç¨‹åº¦ä¸åˆ°æ–½å·¥åŒºçš„è·ç¦»å‘ˆæ­£ç›¸å…³!\n\n"åœŸå£¤å‹å®å’Œæ ¹ç³»æŸä¼¤å¯¼è‡´çš„æ°´åˆ†èƒè¿«!"æ•°æ®ä¸ä¼šè¯´è°ã€‚`;
                    return `ä½ æ‰“å¼€ENVIè½¯ä»¶,å¼€å§‹å»ºæ¨¡ã€‚è¾“å…¥å˜é‡åŒ…æ‹¬:åœŸå£¤æ¹¿åº¦ã€æ–½å·¥éœ‡åŠ¨å¼ºåº¦ã€æ ‘æœ¨å¹´é¾„ã€æ ¹ç³»åˆ†å¸ƒâ€¦â€¦ä½ çš„å°çˆªå­åœ¨é”®ç›˜ä¸Šè·³è·ƒç€ã€‚\n\nç»è¿‡ä¸‰ä¸ªå°æ—¶çš„è®¡ç®—,æ¨¡å‹ç»“æœå‡ºæ¥äº†:æ–½å·¥å¯¼è‡´çš„åœŸå£¤å‹å®ä½¿æ ¹ç³»åŒºåŸŸå­”éš™åº¦ä¸‹é™äº†40%,ä¸¥é‡å½±å“äº†æ ¹ç³»å‘¼å¸å’Œæ°´åˆ†å¸æ”¶ã€‚\n\n"ç†è®ºå’Œå®é™…å®Œç¾å»åˆ!"ä½ æ¾äº†ä¸€å£æ°”,ä¼ æ„Ÿçƒä¹Ÿæ¸©æŸ”åœ°é—ªçƒç€ã€‚`;
                }
            },
            6: {
                text: `ä½ æŠŠåˆ†æç»“æœæ•´ç†æˆä¸€ä»½ä¸“ä¸šæŠ¥å‘Š,åŒ…æ‹¬:\n\nğŸ“Š NDVIæ—¶åºå˜åŒ–å›¾è¡¨\nğŸŒ¡ï¸ åœ°è¡¨æ¸©åº¦å¼‚å¸¸åˆ†å¸ƒå›¾\nğŸ“· é«˜åˆ†è¾¨ç‡æ¤è¢«å¥åº·çŠ¶å†µå½±åƒ\nğŸ“ åŸå› åˆ†æä¸è§£å†³å»ºè®®\n\nç°åœ¨,ä½ éœ€è¦å†³å®šå¦‚ä½•æ¨åŠ¨é—®é¢˜è§£å†³:`,
                choices: [
                    { text: "ç›´æ¥å‘æ ¡é¢†å¯¼æ±‡æŠ¥,è¦æ±‚ç«‹å³åœå·¥æ•´æ”¹", type: "bold" },
                    { text: "å…ˆè”ç³»å›­æ—éƒ¨å’Œæ–½å·¥æ–¹,æä¾›æŠ€æœ¯æŒ‡å¯¼æ–¹æ¡ˆ", type: "cautious" },
                    { text: "åœ¨å­¦æ ¡è®ºå›å‘å¸–å¼•èµ·å…³æ³¨,åŒæ—¶æŠ¥å‘Šç»™ç›¸å…³éƒ¨é—¨", type: "balanced" }
                ]
            },
            7: {
                ending: true
            }
        };

        function updateStats() {
            document.getElementById('round').textContent = `${gameState.round}/7`;
            document.getElementById('score').textContent = gameState.score;
            
            let type = "å‡è¡¡";
            if (gameState.cautiousCount > gameState.boldCount + 1) type = "è°¨æ…";
            else if (gameState.boldCount > gameState.cautiousCount + 1) type = "æœæ•¢";
            document.getElementById('decisionType').textContent = type;
        }

        function showStory(roundNum) {
            const storyBox = document.getElementById('story');
            const choicesDiv = document.getElementById('choices');
            const quizArea = document.getElementById('quiz-area');
            
            quizArea.innerHTML = '';
            choicesDiv.innerHTML = '';

            const currentStory = story[roundNum];

            if (currentStory.ending) {
                showEnding();
                return;
            }

            if (typeof currentStory.text === 'function') {
                const lastChoice = gameState.playerChoices[gameState.playerChoices.length - 1];
                storyBox.innerHTML = currentStory.text(lastChoice);
            } else {
                storyBox.innerHTML = currentStory.text;
            }

            if (currentStory.quiz) {
                showQuiz(currentStory.quizData);
            } else if (currentStory.choices) {
                showChoices(currentStory.choices);
            }
        }

        function showQuiz(quizData) {
            const quizArea = document.getElementById('quiz-area');
            const quizHtml = `
                <div class="quiz-container">
                    <div class="quiz-title">ğŸ“ çŸ¥è¯†æ£€æµ‹ç‚¹</div>
                    <div class="quiz-question">${quizData.question}</div>
                    <div class="choices" id="quiz-choices"></div>
                </div>
            `;
            quizArea.innerHTML = quizHtml;

            const quizChoicesDiv = document.getElementById('quiz-choices');
            quizData.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerHTML = `<span class="choice-number">${String.fromCharCode(65 + index)}</span>${option}`;
                btn.onclick = () => answerQuiz(index, quizData);
                quizChoicesDiv.appendChild(btn);
            });
        }

        function answerQuiz(answer, quizData) {
            const quizArea = document.getElementById('quiz-area');
            const isCorrect = answer === quizData.correct;
            
            if (isCorrect) {
                gameState.score += 20;
                gameState.knowledgeCorrect++;
                quizArea.innerHTML = `
                    <div class="result success">
                        âœ… å›ç­”æ­£ç¡®!ä¼ æ„Ÿçƒå‘å‡ºäº†æ„‰æ‚¦çš„ç»¿å…‰~<br>
                        <small>${quizData.explanation}</small>
                    </div>
                `;
            } else {
                gameState.score += 5;
                quizArea.innerHTML = `
                    <div class="result failure">
                        âŒ ç­”æ¡ˆä¸å¯¹å“¦!ä¼ æ„Ÿçƒç„¦æ€¥åœ°é—ªçƒç€â€¦â€¦<br>
                        <small>æ­£ç¡®ç­”æ¡ˆæ˜¯:${quizData.options[quizData.correct]}<br>
                        ${quizData.explanation}</small>
                    </div>
                `;
            }

            updateStats();

            setTimeout(() => {
                gameState.round++;
                gameState.playerChoices.push(isCorrect);
                showStory(gameState.round);
            }, 3000);
        }

        function showChoices(choices) {
            const choicesDiv = document.getElementById('choices');
            choices.forEach((choice, index) => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerHTML = `<span class="choice-number">${index + 1}</span>${choice.text}`;
                btn.onclick = () => makeChoice(index, choice.type);
                choicesDiv.appendChild(btn);
            });
        }

        function makeChoice(choiceIndex, type) {
            if (type === 'cautious') gameState.cautiousCount++;
            if (type === 'bold') gameState.boldCount++;
            
            gameState.playerChoices.push(choiceIndex);
            gameState.round++;
            updateStats();
            showStory(gameState.round);
        }

        function showEnding() {
            const storyBox = document.getElementById('story');
            const choicesDiv = document.getElementById('choices');
            
            let endingText = "";
            let title = "";
            let description = "";

            const lastChoice = gameState.playerChoices[gameState.playerChoices.length - 1];

            if (lastChoice === 0) {
                endingText = `ä¸€å‘¨å,æ ¡é¢†å¯¼ç´§æ€¥å«åœäº†æ–½å·¥,å¹¶è¦æ±‚æ–½å·¥æ–¹é‡‡å–è¡¥æ•‘æªæ–½ã€‚å·¥äººä»¬åœ¨ä½ çš„æŒ‡å¯¼ä¸‹,å¯¹å‹å®çš„åœŸå£¤è¿›è¡Œäº†æ¾åœŸé€æ°”å¤„ç†,å¢è®¾äº†æ ‘æ ¹ä¿æŠ¤å›´æŒ¡ã€‚\n\nä¸¤ä¸ªæœˆå,ä½ å†æ¬¡ç”¨æ— äººæœºæ‰«ææ¢§æ¡æ—ã€‚NDVIå€¼å›å‡åˆ°0.65,æ ‘å¶é‡æ–°æ³›èµ·äº†ç”Ÿæœºã€‚<span class="sound-effect">"å˜€!"</span>ä½ çš„ä¼ æ„Ÿçƒå‘å‡ºä¸€å£°æ¸…è„†çš„æç¤ºéŸ³,ä»¿ä½›åœ¨è¯´:"ä»»åŠ¡å®Œæˆ!"`;
                title = "æœæ•¢çš„å®ˆæŠ¤è€…";
                description = "ä½ ç”¨ä¸“ä¸šçŸ¥è¯†å’Œæœæ–­è¡ŒåŠ¨,åŠæ—¶æ‹¯æ•‘äº†æ¢§æ¡æ—ã€‚è™½ç„¶è¿‡ç¨‹æœ‰äº›æ³¢æŠ˜,ä½†ä½ çš„å‹‡æ°”å’Œè´£ä»»æ„Ÿè®©æ ¡å›­é‡å›ç”Ÿæœº!";
            } else if (lastChoice === 1) {
                endingText = `åœ¨ä½ çš„æŠ€æœ¯æŒ‡å¯¼ä¸‹,æ–½å·¥æ–¹è°ƒæ•´äº†æ‰“æ¡©æ–¹æ¡ˆ,å¢åŠ äº†å‡éœ‡æªæ–½ã€‚å›­æ—éƒ¨ä¹Ÿå¼€å§‹å¯¹å—æŸæ ‘æœ¨è¿›è¡Œä¸“ä¸šå…»æŠ¤ã€‚\n\næ•´ä¸ªè¿‡ç¨‹æ¸©å’Œè€Œé«˜æ•ˆã€‚ä¸‰ä¸ªæœˆå,æ¢§æ¡æ—çš„NDVIå€¼ç¨³æ­¥å›å‡,æ ‘æœ¨é€æ¸æ¢å¤å¥åº·ã€‚<span class="sound-effect">"å˜€~"</span>ä½ çš„ä¼ æ„Ÿçƒæ»¡æ„åœ°é—ªçƒç€æŸ”å’Œçš„å…‰ã€‚`;
                title = "æ™ºæ…§çš„åè°ƒè€…";
                description = "ä½ ç”¨ç§‘å­¦çš„æ–¹æ³•å’Œæ¸©å’Œçš„æ²Ÿé€š,åœ¨å„æ–¹ä¹‹é—´æ¶èµ·äº†æ¡¥æ¢ã€‚ä¸“ä¸šã€è°¨æ…,åˆå……æ»¡äººæƒ…å‘³,è¿™å°±æ˜¯æœ€å¥½çš„ç ”ç©¶è€…é£èŒƒ!";
            } else {
                endingText = `ä½ çš„å¸–å­åœ¨æ ¡å›­è®ºå›å¼•èµ·çƒ­è®®,å­¦ç”Ÿä»¬çº·çº·è½¬å‘å…³æ³¨ã€‚åœ¨èˆ†è®ºå’Œä¸“ä¸šæ•°æ®çš„åŒé‡æ¨åŠ¨ä¸‹,å­¦æ ¡å¿«é€Ÿå“åº”,æˆç«‹äº†"æ ¡å›­ç”Ÿæ€ç›‘æµ‹å°ç»„",ä½ æˆä¸ºäº†æŠ€æœ¯é¡¾é—®ã€‚\n\nç°åœ¨,æ¯æ£µæ ‘çš„å¥åº·éƒ½è¢«å®æ—¶ç›‘æµ‹ç€ã€‚<span class="sound-effect">"å˜€å˜€!"</span>ä½ çš„ä¼ æ„Ÿçƒéª„å‚²åœ°é—ªçƒâ€”â€”å®ƒçŸ¥é“,ä¸»äººåšå¾—å¾ˆæ£’!`;
                title = "å¹³è¡¡çš„å¼•é¢†è€…";
                description = "ä½ æ—¢æœ‰ä¸“ä¸šèƒ½åŠ›,åˆæ‡‚å¾—å¦‚ä½•å‘åŠ¨ç¾¤ä¼—åŠ›é‡ã€‚åœ¨ç§‘å­¦ä¸ç¤¾ä¼šè´£ä»»ä¹‹é—´æ‰¾åˆ°äº†å®Œç¾å¹³è¡¡,çœŸæ­£çš„å­¦è€…é£èŒƒ!";
            }

            const knowledgeBonus = gameState.knowledgeCorrect > 0 ? "ğŸ† ä½ åœ¨çŸ¥è¯†æµ‹è¯•ä¸­è¡¨ç°å‡ºè‰²!" : "ğŸ“š ä¸‹æ¬¡è¦æ›´åŠ æ³¨é‡ç†è®ºå­¦ä¹ å“¦!";

            storyBox.innerHTML = `
                <div class="ending">
                    <h2>ğŸ¬ ç»“å±€</h2>
                    <p style="line-height: 1.8; margin: 20px 0;">${endingText}</p>
                    <div class="title-badge">ğŸ–ï¸ ${title}</div>
                    <p style="color: #666; margin: 20px 0;">${description}</p>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <strong>æœ€ç»ˆè¯„åˆ†</strong><br>
                        çŸ¥è¯†åˆ†æ•°:${gameState.score}/100<br>
                        å†³ç­–é£æ ¼:${gameState.cautiousCount > gameState.boldCount ? 'è°¨æ…å‹' : gameState.boldCount > gameState.cautiousCount ? 'æœæ•¢å‹' : 'å¹³è¡¡å‹'}<br>
                        ${knowledgeBonus}
                    </div>
                    <button class="restart-btn" onclick="location.reload()">ğŸ”„ é‡æ–°å¼€å§‹å†’é™©</button>
                </div>
            `;
            
            choicesDiv.innerHTML = '';
        }

        showStory(1);
        updateStats();
    </script>
</body>
</html>
